# 高校生・大学生マッチングアプリ レビュー機能 要件定義書

## 1. プロジェクト概要

### 1.1 アプリケーション名
高校生・大学生マッチングアプリ（レビュー機能）

### 1.2 目的
- 高校生と大学生のマッチングアプリの一部として、WEB面談後のレビュー機能を実装
- 将来的には企業のダイレクトリクルーティング機能も統合予定
- 高校生が大学生との面談を評価し、他の高校生が参考にできる仕組みを提供

### 1.3 対象ユーザー
- **主要ユーザー**: 高校生（レビュー投稿者）
- **被評価者**: 大学生（レビュー対象者）

## 2. 機能要件

### 2.1 必須機能（フェーズ1）
1. **レビュー投稿機能**
2. **レビュー一覧表示機能**
3. **レビューの検索・絞り込み機能**
4. **ユーザー管理機能**
    - ユーザー登録
    - ログイン・ログアウト
    - ユーザー一覧表示（管理者向け）
    - ユーザー編集・削除（管理者向け）
5. **個人レビュー管理機能**
    - 自分の投稿レビュー一覧表示
    - 自分のレビューの編集・削除

### 2.2 後期実装予定機能（フェーズ2）
- 大学生のプロフィール詳細表示
- マイページ機能

## 3. レビュー機能詳細仕様

### 3.1 レビュー評価項目
以下の4項目を5段階の星評価で評価：
- **話しやすさ**
- **参考になった度** 
- **ワクワク度**
- **時間の正確性**

### 3.2 レビュー投稿内容
- **評価項目**: 上記4項目の星評価（1-5段階）
- **コメント**: 自由記述
- **レビュー日**: Y年mm月dd日形式で自動記録

### 3.3 レビュー投稿者情報
- **ニックネーム**: 任意入力
- **高校名**: 選択式
- **学年**: 選択式（1年、2年、3年）
- **匿名投稿**: 上記情報のみで個人特定不可

### 3.4 レビュー対象者情報
- **大学生氏名**: 必須
- **大学名**: 必須  
- **学部・学科**: 必須
- **学年**: 必須（1年、2年、3年、4年、院生）

### 3.5 レビュー公開範囲
- 全ての高校生が閲覧可能
- 大学生も自分に対するレビューを閲覧可能

### 3.6 レビュー編集・削除権限
- **投稿者のみ**: 自分が投稿したレビューのみ編集・削除可能
- **管理者**: 全てのレビューを編集・削除可能
- **権限チェック**: レビューID と ユーザーIDの紐付けを必須とする

## 3.7 ユーザー権限とアクセス制御

### 3.7.1 一般ユーザー権限
- レビュー一覧の閲覧
- レビューの投稿
- 自分の投稿レビューの閲覧・編集・削除
- 検索・絞り込み機能の利用

### 3.7.2 管理者権限  
- 一般ユーザーの全機能
- ユーザー管理（一覧・編集・削除・登録）
- 全レビューの管理
- システム管理機能へのアクセス

### 3.7.3 アクセス制限ページ
以下のページは管理者のみアクセス可能とする：
- `user_list.php`（ユーザー一覧）
- `user_edit.php`（ユーザー編集）
- `admin_register.php`（管理者用ユーザー登録）
- `view_reviews_table.php`（データベース直接参照）

### 3.7.4 レビュー投稿者識別機能
- レビューテーブルに `user_id` カラムを追加
- 投稿時にログインユーザーのIDを自動記録
- 編集・削除時は投稿者本人かどうかをチェック

## 4. 検索・絞り込み機能

### 4.1 絞り込み条件
- **大学名**: プルダウン選択
- **学部**: プルダウン選択  
- **評価点数**: 4.5以上、4.0以上、3.5以上、3.0以上
- **投稿日**: 1週間以内、1ヶ月以内、3ヶ月以内

### 4.2 表示順序
- 最新投稿順（デフォルト）
- 評価順（高い順）
- 大学名順

## 5. 技術仕様

### 5.1 開発環境
- **サーバー**: XAMPP（Apache + PHP + MySQL）
- **言語**: PHP（素のPHP、フレームワーク不使用）
- **データベース**: MySQL
- **フロントエンド**: HTML + CSS（素のCSS）+ JavaScript

### 5.2 対応ブラウザ
- Chrome（最新版）
- Safari（最新版）
- Firefox（最新版）
- Edge（最新版）

## 6. データベース設計

### 6.1 テーブル構成

#### 6.1.1 大学生テーブル（students）
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 大学生ID |
| name | VARCHAR(100) | NOT NULL | 氏名 |
| university | VARCHAR(100) | NOT NULL | 大学名 |
| department | VARCHAR(100) | NOT NULL | 学部・学科 |
| grade | INT | NOT NULL | 学年 |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | 登録日時 |

#### 6.1.2 レビューテーブル（reviews）
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | レビューID |
| student_id | INT | FOREIGN KEY | 大学生ID |
| user_id | INT | FOREIGN KEY | 投稿者ユーザーID |
| reviewer_nickname | VARCHAR(50) | NULL | 投稿者ニックネーム |
| reviewer_school | VARCHAR(100) | NOT NULL | 投稿者高校名 |
| reviewer_grade | INT | NOT NULL | 投稿者学年 |
| friendliness | INT | NOT NULL | 話しやすさ（1-5） |
| helpfulness | INT | NOT NULL | 参考になった度（1-5） |
| excitement | INT | NOT NULL | ワクワク度（1-5） |
| punctuality | INT | NOT NULL | 時間の正確性（1-5） |
| comment | TEXT | NULL | コメント |
| review_date | DATE | NOT NULL | レビュー日 |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | 投稿日時 |

#### 6.1.3 ユーザーテーブル（users）
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | ユーザーID |
| name | VARCHAR(64) | NOT NULL | ユーザー名 |
| lid | VARCHAR(128) | NOT NULL, UNIQUE | ログインID |
| lpw | VARCHAR(255) | NOT NULL | ログインパスワード（ハッシュ化） |
| kanri_flg | INT | NOT NULL, DEFAULT 0 | 管理者フラグ（0:一般, 1:管理者） |
| life_flg | INT | NOT NULL, DEFAULT 0 | アクティブフラグ（0:アクティブ, 1:非アクティブ） |
| created_at | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | 登録日時 |

## 7. 画面構成

### 7.1 画面一覧
1. **トップページ**（レビュー一覧表示）
2. **レビュー投稿ページ**
3. **レビュー詳細ページ**
4. **検索結果ページ**
5. **ログインページ**
6. **ユーザー登録ページ**
7. **マイレビューページ**（個人の投稿レビュー管理）
8. **ユーザー一覧ページ（管理者用）**
9. **ユーザー編集ページ（管理者用）**
10. **管理者用ユーザー登録ページ**
11. **データベース管理ページ（管理者用）**

### 7.2 画面遷移
```
【一般ユーザー】
トップページ（レビュー一覧）
├── レビュー投稿ページ → 投稿完了後 → トップページ
├── レビュー詳細ページ → 戻る → トップページ  
├── 検索・絞り込み → 検索結果ページ → トップページ
├── マイレビューページ
│   ├── 自分のレビュー編集 → 更新後 → マイレビューページ
│   └── 自分のレビュー削除 → マイレビューページ
└── ログインページ
    ├── ログイン成功 → トップページ
    └── ユーザー登録ページへ

【管理者ユーザー】  
上記 + 以下の管理機能
├── ユーザー一覧ページ
│   ├── ユーザー編集ページ → 更新後 → ユーザー一覧ページ
│   ├── ユーザー削除 → ユーザー一覧ページ
│   └── 管理者用ユーザー登録ページ → 登録後 → ユーザー一覧ページ
└── データベース管理ページ（view_reviews_table.php）
```

### 7.3 権限別アクセス制御
#### 7.3.1 一般ユーザーアクセス可能ページ
- `index.php`（トップページ）
- `post_review.php`（レビュー投稿）
- `edit_review.php`（自分のレビューのみ）
- `delete_review.php`（自分のレビューのみ）
- `my_reviews.php`（マイレビューページ）※新規作成予定
- `login.php`、`logout.php`、`register.php`

#### 7.3.2 管理者専用ページ
- `user_list.php`（ユーザー一覧）
- `user_edit.php`（ユーザー編集）
- `admin_register.php`（管理者用ユーザー登録）
- `view_reviews_table.php`（データベース管理）
- 全レビューの編集・削除権限

## 8. 開発用テストデータ

### 8.1 大学生ダミーデータ（5-10名程度）
- 東京大学、早稲田大学、慶應義塾大学、明治大学、日本大学等の有名大学
- 文系・理系の様々な学部
- 1-4年生、院生を含む

### 8.2 レビューダミーデータ
- 上記大学生に対する複数のレビュー
- 様々な評価点数とコメント
- 過去3ヶ月程度の日付範囲

### 8.3 ユーザーダミーデータ
- 管理者ユーザー: 1名（lid: admin, lpw: password, kanri_flg: 1）
- 一般ユーザー: 2-3名（kanri_flg: 0）

## 9. 開発スケジュール

### Phase 1: レビュー機能実装（優先）
1. データベース設計・構築（usersテーブル追加）
2. ユーザー・大学生ダミーデータ投入
3. ユーザー登録・認証機能実装
4. レビュー投稿機能実装
5. レビュー一覧表示機能実装  
6. 検索・絞り込み機能実装
7. ユーザー管理機能実装（管理者向け）
8. **権限制御・セキュリティ強化**
   - レビューテーブルにuser_idカラム追加
   - 投稿者識別機能実装
   - アクセス権限チェック強化
   - マイレビューページ作成
9. CSS装飾・レスポンシブ対応

### Phase 1.5: セキュリティ・ユーザビリティ改善
1. **レビュー投稿者紐付け機能**
   - データベーススキーマ変更（user_idカラム追加）
   - 既存レビューデータの移行
2. **権限別アクセス制御**
   - 編集・削除権限チェック実装
   - 管理者専用ページアクセス制限
3. **マイレビュー管理機能**
   - 個人投稿レビュー一覧ページ
   - 自分のレビューのみ編集・削除

### Phase 2: ユーザー管理機能（後期）
1. マイページ機能
2. 大学生のプロフィール詳細表示

## 10. 非機能要件

### 10.1 セキュリティ
- SQLインジェクション対策
- XSS（クロスサイトスクリプティング）対策
- CSRF対策

### 10.2 パフォーマンス
- ページ読み込み時間: 3秒以内
- 同時アクセス: 50人程度まで対応

### 10.3 ユーザビリティ
- 直感的で分かりやすいUI
- スマートフォン対応（レスポンシブデザイン）

## 11. 制約事項

- 開発期間: Phase 1を優先実装
- 予算: 無料ツール・オープンソースのみ使用
- 運用: 学習目的のため本格運用は想定していない

---

**作成日**: 2025年6月21日  
**バージョン**: 1.0  
**作成者**: 開発チーム
