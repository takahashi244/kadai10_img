<?php
/**
 * サンプルデータ投入スクリプト
 * 大学生データとレビューデータを追加
 */

// 直接データベース接続（コマンドライン用）
$host = 'localhost';
$dbname = 'student_review_app';
$user = 'root';
$pass = '';

try {
    $pdo = new PDO("mysql:host=$host;dbname=$dbname;charset=utf8mb4", $user, $pass);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $pdo->exec("SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci");
    
    echo "サンプルデータを投入しています...\n";
    
    // 既存の大学生データとレビューデータを削除（ユーザーデータは保持）
    $pdo->exec("DELETE FROM reviews");
    $pdo->exec("DELETE FROM students");
    $pdo->exec("ALTER TABLE students AUTO_INCREMENT = 1");
    $pdo->exec("ALTER TABLE reviews AUTO_INCREMENT = 1");
    
    echo "既存のサンプルデータを削除しました。\n";
    
    // 大学生サンプルデータの投入
    $students_data = [
        ['山田太郎', '東京大学', '工学部情報理工学科', 3],
        ['佐藤花子', '早稲田大学', '政治経済学部経済学科', 2],
        ['田中一郎', '慶應義塾大学', '理工学部情報工学科', 4],
        ['鈴木美咲', '明治大学', '商学部マーケティング学科', 2],
        ['高橋健太', '日本大学', '文理学部心理学科', 3],
        ['渡辺優子', '立教大学', '社会学部現代文化学科', 1],
        ['中村亮介', '法政大学', 'デザイン工学部建築学科', 4],
        ['小林麻衣', '青山学院大学', '国際政治経済学部', 2],
        ['加藤翔太', '上智大学', '理工学部機械工学科', 3],
        ['山本あいり', '東京理科大学', '薬学部薬学科', 5]
    ];
    
    $stmt = $pdo->prepare("INSERT INTO students (name, university, department, grade) VALUES (?, ?, ?, ?)");
    
    foreach ($students_data as $student) {
        $stmt->execute($student);
    }
    
    echo "大学生サンプルデータ（10名）を投入しました。\n";
    
    // レビューサンプルデータの投入
    $reviews_data = [
        // 山田太郎さんへのレビュー
        [1, 'ゆうき', '渋谷高校', 3, 5, 5, 4, 5, 'とても親しみやすく、進路について丁寧に教えてくれました！工学部の実際の授業内容や就職先について具体的に聞けて良かったです。', '2025-06-15'],
        [1, NULL, '新宿高校', 2, 4, 5, 5, 4, 'プログラミングの勉強方法を詳しく教えてもらいました。東大の雰囲気も教えてもらえて、モチベーションが上がりました！', '2025-06-10'],
        [1, 'たくや', '池袋高校', 3, 5, 4, 4, 5, '時間通りに始まって、質問にも丁寧に答えてくれました。理系選択で悩んでいたけど、背中を押してもらえた感じです。', '2025-06-08'],
        
        // 佐藤花子さんへのレビュー
        [2, 'みなみ', '品川女子学院', 2, 5, 5, 5, 5, '同じ女子として、大学生活のリアルな話が聞けて参考になりました！経済学の面白さを教えてもらえて、文系選択に自信が持てました。', '2025-06-12'],
        [2, 'あかり', '桜蔭高校', 3, 4, 4, 4, 4, '早稲田の雰囲気やサークル活動について詳しく聞けました。受験勉強のコツも教えてもらえて助かりました。', '2025-06-05'],
        
        // 田中一郎さんへのレビュー
        [3, 'りょうた', '麻布高校', 3, 3, 4, 3, 4, '慶應の理工学部について詳しく教えてもらいました。ちょっと緊張気味でしたが、質問には答えてくれました。', '2025-06-14'],
        [3, NULL, '開成高校', 3, 4, 5, 4, 5, '研究室の話や大学院進学についても聞けて良かったです。将来のキャリアパスが具体的にイメージできました。', '2025-06-07'],
        
        // 鈴木美咲さんへのレビュー
        [4, 'なつき', '女子学院', 2, 5, 4, 5, 5, '明るくて話しやすい先輩でした！マーケティングの勉強内容について、具体例を交えて説明してくれて分かりやすかったです。', '2025-06-11'],
        [4, 'かえで', '雙葉高校', 2, 5, 5, 4, 4, '商学部の魅力をたくさん教えてもらいました。アルバイトと勉強の両立方法も参考になりました。', '2025-06-03'],
        
        // 高橋健太さんへのレビュー
        [5, 'ひろき', '芝高校', 1, 4, 4, 3, 4, '心理学に興味があったので、とても参考になりました。大学での実際の研究内容も教えてもらえて良かったです。', '2025-06-13'],
        
        // 渡辺優子さんへのレビュー
        [6, 'さくら', '豊島岡女子学園', 1, 5, 4, 5, 5, '1年生なのに、とてもしっかりしていて驚きました！大学生活の楽しさが伝わってきて、早く大学生になりたくなりました。', '2025-06-09'],
        
        // 中村亮介さんへのレビュー
        [7, 'だいき', '巣鴨高校', 3, 4, 5, 4, 4, '建築学科の課題の大変さと楽しさの両方を教えてもらいました。作品も見せてもらえて、とても刺激になりました。', '2025-06-06'],
        
        // 小林麻衣さんへのレビュー
        [8, 'ももか', '白百合学園', 2, 5, 5, 5, 5, '国際関係に興味があったので、とても有意義な時間でした！留学の話も聞けて、将来の目標がより明確になりました。', '2025-06-04'],
        
        // 加藤翔太さんへのレビュー
        [9, 'しょうた', '攻玉社高校', 3, 4, 4, 3, 5, '機械工学の実習内容について詳しく教えてもらいました。理系の進路選択の参考になりました。時間もきっちり守ってくれて好印象でした。', '2025-06-02'],
        
        // 山本あいりさんへのレビュー
        [10, 'ゆい', '東京女学館', 3, 5, 5, 4, 4, '薬学部の6年制について詳しく聞けました。国家試験の話や就職先についても教えてもらえて、とても参考になりました。', '2025-06-01']
    ];
    
    $stmt = $pdo->prepare("
        INSERT INTO reviews (student_id, reviewer_nickname, reviewer_school, reviewer_grade, friendliness, helpfulness, excitement, punctuality, comment, review_date) 
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    ");
    
    foreach ($reviews_data as $review) {
        $stmt->execute($review);
    }
    
    echo "レビューサンプルデータ（15件）を投入しました。\n";
    
    // データ投入結果の確認
    $student_count = $pdo->query("SELECT COUNT(*) FROM students")->fetchColumn();
    $review_count = $pdo->query("SELECT COUNT(*) FROM reviews")->fetchColumn();
    $user_count = $pdo->query("SELECT COUNT(*) FROM users")->fetchColumn();
    
    echo "\n=== データ投入完了 ===\n";
    echo "大学生: {$student_count}名\n";
    echo "レビュー: {$review_count}件\n";
    echo "ユーザー: {$user_count}名\n";
    echo "\nPHPMyAdminで確認できます！\n";
    echo "URL: http://localhost/phpmyadmin/\n";
    echo "データベース: student_review_app\n";
    
} catch (Exception $e) {
    echo "エラー: " . $e->getMessage() . "\n";
}
?>
